<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>iOS 8会带来什么——arm64时代的到来 | 不掏蜂窝的熊</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS 8会带来什么——arm64时代的到来</h1><a id="logo" href="/.">不掏蜂窝的熊</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">iOS 8会带来什么——arm64时代的到来</h1><div class="post-meta">Aug 20, 2014<span> | </span><span class="category"><a href="/categories/学而后思/">学而后思</a></span></div><div class="post-content"><p>2011年，iOS 5发布，引入了「通知中心」。</p>
<p>2012年，iPhone 5发布，“驴脸”iPhone突破了iPhone 320*480的默认屏幕尺寸，iPhone开发者开始接受「多尺寸屏幕适配」的概念。</p>
<p>2013年，iOS 7发布，全新设计的iOS 7，让整个iPhone设计圈，甚至是整个智能手机设计圈，刮起了一阵「iOS 7」风潮。半年之后，扁平化风格、动态效果、毛玻璃、手势切换视图等设计理念就已深入人心。</p>
<p>不经意间，成为iOS开发者已快三年。每年新版iPhone和iOS的发布，已经成为开发者的「年经」——虽不至于脱层皮，几个星期的阵痛是必然的。就如上面列举的iOS版本的新特性，为了适配它们，开发者需要付出超乎平常的工作量。</p>
<p>2014年，iOS 8和iPhone 6也将如期到来。从WWDC 2014透露出来的消息，iPhone开发者将面临什么——大屏iPhone？Swift？屏幕尺寸适配早在2年前就已经经历过一次，Swift也没有颠覆OC的必要性和资本（参考这么多年关于ARC和MRC的讨论的案例）。那iOS 8会带来什么？</p>
<p>笔者凭着多年iOS开发训练出来的嗅觉，不靠谱的猜测一回：<strong>应用程序将会全面支持arm64架构</strong>。</p>
<p>“arm64？iPhone 5s发布的时候，arm64时代不是已经到来了么？”</p>
<p>“iPhone5s搭配了64位的双核处理器，支持arm64指令集，但会向下兼容armv7、armv7s。应用程序，特别是比较老的大型应用程序，一般会选择性忽略64位这个新特性，即使苹果吹得天花乱坠。”</p>
<p>“为什么要忽略呢？”</p>
<p>“64位的适配工作，可不简单。抛开大量的int、long转换不说，大量年代久远的第三方闭源库，可是没能预见手机支持64位CPU这一天，如今别说维护，可能连公司都不在了，上哪找arm64架构的第三方库。另外支持arm64，APP的可执行程序体积大小将会翻倍，在国内还有大量对手机流量极度敏感的用户的大环境下（感谢运营商，感谢国家），应用程序大小属于核心指标，用户量越大的应用程序，对这个指标会越敏感。还有还有，arm64最低支持的iOS版本是iOS 5.1.1，你首先需要过了产品那一关，说服TA放弃低版本用户。”</p>
<p>“那为啥要等到iOS 8发布的时候，arm64的时代才会到来？”</p>
<p>“重点来了！”</p>
<p>「<a href="https://developer.apple.com/library/prerelease/iOS/documentation/General/Conceptual/ExtensibilityPG/ExtensionCreation.html" target="_blank" rel="noopener">App Extension Programming Guide</a>」里面提到：</p>
<blockquote>
<p>An app extension target must include the arm64 architecture in its Architectures build settings or it will be rejected by the App Store. Xcode includes this architecture with its “Standard architectures” setting when you create a new app extension target.</p>
<p>If your containing app target links to an embedded framework, the app must also include the arm64 architecture or it will be rejected by the App Store.</p>
</blockquote>
<p><del>也就是说，需要用到iOS 8新特性「embedded framework」的应用程序，需要支持arm64架构，而「embedded framework」这个技术，又是支持iOS 8新特性「Extension」必不可少的。</del></p>
<p><del><strong>一句话，想要使用iOS 8的新特性「Extension」，应用程序需要支持arm64架构。而「Extension」对于应用程序（特别是大型应用程序）的意义，是不言而喻的。</strong></del></p>
<p><del>假如不支持呢？被App Store拒绝上架不说，在实际的测试中，「Extension」或者「Containing App」中有一个没有支持arm64架构，在64位机器上（iPhone 5s）是工作不正常的。个人猜测这个和iOS 8上新的通讯机制IPC有关：32位和64位会导致问题，和数据传递脱不了关系。</del></p>
<p><del>用到IPC技术的还有什么呢？呵呵WKWebView，以后可能还会更多。</del></p>
<p><del>拭目以待！</del></p>
<p>== 更新于2014.8.21 ==</p>
<p>早上更新了Xcode 6 beta6，发现我的认识又被刷新了：</p>
<ol>
<li>之前出现的32位「Containing App」和64位「Extension」在Xcode调试不通的问题，在Xcode 6 beta6 已经解决得差不多了，偶尔无法调试，怀疑是Xcode 6的bug</li>
<li>「embedded framework」并非「Extension」的必要技术，「embedded framework」解决的问题，可以尝试通过其它手段来解决</li>
<li>「Extension」或者「Containing App」中有一个没有支持arm64架构，在64位机器上（iPhone 5s）已经可以工作正常</li>
</ol>
<p>说白了，之前发现的那一堆iPhone 5s上关于「Extension」调试和工作不正常的问题，可能是由于Xcode 6 的bug导致的，现在在beta6已经解决得差不多了；此外，我也太过于看重「embedded framework」对于「Extension」的意义，「embedded framework」只是共享代码，并不是「Extension」的必要技术。上面两个原因导致我太过草率地做了这么一个错误的结论。<strong>让32位的应用程序支持64位的「Extension」，看来还是可以实现的。还是需要等到iOS 8正式版发布，才能下最终的结论。</strong></p>
<p>下个版本就是GM了，希望Xcode不要再抽风了。</p>
<p>另外，单独包含32位架构的程序，使用WKWebView运行在64位机器上，会工作不正常，打开网页会白屏，并输出错误提示：</p>
<blockquote>
<p>Received an invalid message “RemoteLayerTreeDrawingAreaProxy.CommitLayerTree” from the web process.</p>
</blockquote>
<p>基本可以确定是IPC的bug，具体原因可以看<a href="http://stackoverflow.com/questions/25854143/wkwebview-intermittent-blank-screen-issue" target="_blank" rel="noopener">这里</a>。</p>
<p>== 更新于2014.9.11 ==</p>
<p>昨天更新了GM版，出了一个bug：提交应用时会被报错：「 ERROR ITMS-9000: “Invalid Binary. The binary XXX.app is missing architectures [arm64] 」。今天被证实是苹果的一个bug，并被很快修复。虚惊一场。不过从种种迹象看来，ARM64架构的支持应该会很快提上日程。</p>
<p>== 更新于2014.11.6 ==</p>
<p><a href="http://www.hotobear.com/wp-content/uploads/2014/08/QQ20141106-1@2x.jpg" target="_blank" rel="noopener"><img src="http://www.hotobear.com/wp-content/uploads/2014/08/QQ20141106-1@2x.jpg" alt="QQ20141106-1@2x"></a></p>
<p>具体消息见<a href="https://developer.apple.com/news/?id=10202014a" target="_blank" rel="noopener">这里</a>。</p>
<p>为了避免到时手忙脚乱的，建议现在开始适配arm64，特别是大项目。</p>
<p>== 更新于2014.12.21 ==</p>
<p><a href="http://www.hotobear.com/wp-content/uploads/2014/08/QQ20141221-1@2x.jpg" target="_blank" rel="noopener"><img src="http://www.hotobear.com/wp-content/uploads/2014/08/QQ20141221-1@2x.jpg" alt="QQ20141221-1@2x"></a></p>
<p>具体消息见<a href="https://developer.apple.com/news/?id=12172014b" target="_blank" rel="noopener">这里</a>。</p>
<p>意思就是说，旧APP只需要在2015.6.1前支持Arm64就可以了，新APP才需要在2015.2.1前支持Arm64。苹果你大爷，尿尿都是尿一半的货！</p>
</div><div class="tags"><a href="/tags/iOS/">iOS</a><a href="/tags/iOS-8/">iOS 8</a></div><div class="post-nav"><a class="pre" href="/2014/09/11/e5-85-8d-e8-b4-b9-e7-9a-84-e5-8d-88-e9-a4-90-e4-b8-8d-e5-8f-af-e9-9d-a0-e8-ad-a6-e6-83-95wordpress-e5-85-8d-e8-b4-b9-e4-b8-bb-e9-a2-98-e7-9a-84-e6-81-b6-e6-84-8f-e4-bb-a3-e7-a0-81/">免费的午餐不可靠——警惕WordPress免费主题的恶意代码</a><a class="next" href="/2014/08/16/today-is-a-beautiful-day/">Today Is A Beautiful Day</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://hotobear.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/学而后思/">学而后思</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/学而后思/调试技巧/">调试技巧</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学而后思/越狱开发/">越狱开发</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活点滴/">生活点滴</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/调色板/">调色板</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/熊本熊/" style="font-size: 15px;">熊本熊</a> <a href="/tags/阶段总结/" style="font-size: 15px;">阶段总结</a> <a href="/tags/AKB48/" style="font-size: 15px;">AKB48</a> <a href="/tags/一吻定情/" style="font-size: 15px;">一吻定情</a> <a href="/tags/偶像/" style="font-size: 15px;">偶像</a> <a href="/tags/博客日志/" style="font-size: 15px;">博客日志</a> <a href="/tags/驾校/" style="font-size: 15px;">驾校</a> <a href="/tags/城市物种日历/" style="font-size: 15px;">城市物种日历</a> <a href="/tags/焦虑/" style="font-size: 15px;">焦虑</a> <a href="/tags/猎豹浏览器/" style="font-size: 15px;">猎豹浏览器</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/iOS调试技巧/" style="font-size: 15px;">iOS调试技巧</a> <a href="/tags/WordPress/" style="font-size: 15px;">WordPress</a> <a href="/tags/动画/" style="font-size: 15px;">动画</a> <a href="/tags/iOS-7/" style="font-size: 15px;">iOS 7</a> <a href="/tags/Safari/" style="font-size: 15px;">Safari</a> <a href="/tags/梶浦由记香港演唱会/" style="font-size: 15px;">梶浦由记香港演唱会</a> <a href="/tags/越狱开发/" style="font-size: 15px;">越狱开发</a> <a href="/tags/iOS-8/" style="font-size: 15px;">iOS 8</a> <a href="/tags/游戏/" style="font-size: 15px;">游戏</a> <a href="/tags/WebKit/" style="font-size: 15px;">WebKit</a> <a href="/tags/Music-and-Me/" style="font-size: 15px;">Music and Me</a> <a href="/tags/React-Native/" style="font-size: 15px;">React Native</a> <a href="/tags/iOS-9/" style="font-size: 15px;">iOS 9</a></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">不掏蜂窝的熊.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>